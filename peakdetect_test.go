package peakdetect

import (
	"fmt"
	"testing"
)

func TestPeakDetect(t *testing.T) {
	energies := [...]float64{
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0.007,
		0,
		0.007,
		0.014,
		0.049,
		0.056,
		0.07,
		0.104,
		0.077,
		0.452,
		0.571,
		0.473,
		0.557,
		0.557,
		0.696,
		0.313,
		0.264,
		0.244,
		0.167,
		0.167,
		0.097,
		0.111,
		0.084,
		0.097,
		0.097,
		0.07,
		0.049,
		0.042,
		0.042,
		0.035,
		0.028,
		0.021,
		0.028,
		0.014,
		0.021,
		0.007,
		0.007,
		0.014,
		0.007,
		0.007,
		0.007,
		0.007,
		0.007,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
	}

	periods := [...]float64{
		1 / 0.025,
		1 / 0.03,
		1 / 0.035,
		1 / 0.04,
		1 / 0.045,
		1 / 0.05,
		1 / 0.055,
		1 / 0.06,
		1 / 0.065,
		1 / 0.07,
		1 / 0.075,
		1 / 0.08,
		1 / 0.085,
		1 / 0.09,
		1 / 0.095,
		1 / 0.101,
		1 / 0.11,
		1 / 0.12,
		1 / 0.13,
		1 / 0.14,
		1 / 0.15,
		1 / 0.16,
		1 / 0.17,
		1 / 0.18,
		1 / 0.19,
		1 / 0.2,
		1 / 0.21,
		1 / 0.22,
		1 / 0.23,
		1 / 0.24,
		1 / 0.25,
		1 / 0.26,
		1 / 0.27,
		1 / 0.28,
		1 / 0.29,
		1 / 0.3,
		1 / 0.31,
		1 / 0.32,
		1 / 0.33,
		1 / 0.34,
		1 / 0.35,
		1 / 0.36,
		1 / 0.37,
		1 / 0.38,
		1 / 0.39,
		1 / 0.4,
		1 / 0.41,
		1 / 0.42,
		1 / 0.43,
		1 / 0.44,
		1 / 0.45,
		1 / 0.46,
		1 / 0.47,
		1 / 0.48,
		1 / 0.49,
		1 / 0.5,
		1 / 0.51,
		1 / 0.52,
		1 / 0.53,
		1 / 0.54,
		1 / 0.55,
		1 / 0.56,
		1 / 0.57,
		1 / 0.58,
	}

	mini, minv, maxi, maxv := PeakDetect(energies[:], 0.01)

	fmt.Println("PeakDetect: Max")
	for i := 0; i < len(maxv); i++ {
		fmt.Printf("Period: %f, Energy: %f\n", periods[maxi[i]], maxv[i])
	}

	fmt.Println("\nPeakDetect: Min")
	for i := 0; i < len(minv); i++ {
		fmt.Printf("Period: %f, Energy: %f\n", periods[mini[i]], minv[i])
	}
}
